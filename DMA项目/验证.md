![[Pasted image 20250727000855.png]]
## 1、**$finish at simulation time                    0**
**仿真“ 0 ps 就 $finish ”**
UVM 根在 time 0 没看到objection，于是直接结束
但 **run_phase 本身根本没机会执行**——因为 UVM 根在 **run_phase 开始之前** 就检查了一次 _还有没有 objection_。如果没有，它立刻 `$finish`。
## 2、第一组地址为0的数据和地址没进来
![[Pasted image 20250807154848.png]]
driver直接写接口信号，不用clocking-block
clocking drv_cb @(posedge clk);
    default input #0  output #0;   **// ← skew #0 ≠ “立刻”，而是“在下一个时钟沿”**
    output awaddr, wdata, awvalid, wvalid;
endclocking
- `drv_cb.awvalid <= 1;` **不会立刻把 awvalid 变成 1**。  
    它会在 **下一次 posedge clk 的 Active region** 才真正驱动。
    
- 再执行 `@(posedge clk);` 进入下一拍；  
    第二句 `drv_cb.awvalid <= 0;` 又被排队到 **再下一个 posedge**。
    ![[Pasted image 20250807162022.png]]
**主链路**（4 次写 → 1 次 COPY → DONE 中断）

|时刻|重要信号|观察到的状态|解释|
|---|---|---|---|
|**0 ns-10 ns**|`rst_n`=0 →1|复位结束，所有寄存器清零|OK|
|**10 ns-40 ns**|`s_axil_awaddr` = **0 / 4 / 8 / C**`s_axil_wdata` = **1000_0000 / 2000_0000 / 10 / 1**`awvalid / wvalid` = **高电平持续 4 拍**`awready / wready` = **恒 1**|4 连写：0x00 写 SRC0x04 写 DST0x08 写 LEN0x0C 写 START|AXI-Lite 允许 Valid 保持高，只要 Ready=1 每拍都在握手；stub 逻辑接受 4 次写，地址/数据顺序正确|
|**约 45 ns**|`m_axi_arvalid` = 1`m_axi_araddr` = **0**|DUT 进入 **COPY** 状态，对齐检查通过，打一发读地址|stub 只需 1 拍握手，`arready` 常 1，立即成功|
|**约 55 ns**|`irq_done` = 1|DUT 转 **DONE**，拉成功中断 1 拍|Monitor 把 `"DONE"` 发到 Scoreboard，Scoreboard 判 PASS|
|**>55 ns**|`irq_done` 返回 0无 `irq_err`|DUT 回到 **IDLE**|仿真收尾，TEST drop objection，退出|

### 为什么 `awvalid`/`wvalid` 持续高也没问题

- 我们的 stub `awready` 恒 1：握手条件 `valid & ready` 每拍都成立。
    
- 地址、数据在每个上升沿稳定更新，因此四个写都被采样。
    
- 正常 AXI-Lite 更“规范”的写法是 **1-pulse 脉冲**；若你想完全符合协议，可以把 driver 改成“每拍拉高一拍再拉低”，但对当前 stub 功能影响不大。
    

### 结论

- **传输成功**：Scoreboard 日志报 _Transfer completed OK_，`irq_done` 波形也印证。
    
- **功能闭环**：Driver → DUT → Monitor → Scoreboard 信号流正确。
    
- 接下来可做：
    
    1. 把 driver valid 改成 1-pulse，使波形更“干净”；
        
    2. 写错误注入序列（SRC 奇地址）验证 `irq_err` 路径；
        
    3. 加 covergroup / assertion。
**CPU 四次 AXI-Lite 写**→ DMA 把寄存器记住 → 写 START 触发 COPY → **DMA 发 AXI 读握手**（m_axi_arvalid）→ 握手 OK 转 DONE → **拉 irq_done**，验证环境收到 PASS。
### 正确报错
#### 问题1：src给不进去
原因：要等rst完成再开始给信号
#### 问题2：error后仿真卡死
原因：scoreboard 报UVM_error后。basic_test收不到触发事件就会一直等下去
给error一个事件触发test继续

![[Pasted image 20250807215134.png]]